<!DOCTYPE html>
<html lang="en" xmlns:jad="http://jadaptive.com/jadaptive">
<body>
<div class="wrapper">
<header jad:id="header"></header>
<main class="container my-auto">
   <div class="row justify-content-center">
         <div class="col-10">
            <div class="card">
         	   	<div class="card-header"><span>Generate Authorized Key</span><div class="float-right"><a href="/app/ui/table/authorizedKeys"><i class="fa fa-times"></i></a></div></div>
       			<div class="card-body">		
         	<form id="generateForm" enctype="multipart/form-data" method="POST">
      		
      		<div id="nameGroup" class="form-group"> 
          		<label for="name" class="col-form-label" jad:bundle="authorizedKeys" jad:i18n="name.name">Name</label> 
          		<input type="text" id="name" name="name" class="form-control" value=""> 
          		<small class="form-text text-muted" jad:bundle="authorizedKeys" jad:i18n="name.desc"></small> 
         	</div>
         	<div class="form-group"> 
          		<label for="passphrase" class="col-form-label" jad:bundle="authorizedKeys" jad:i18n="passphrase.name">Passphrase</label> 
          		<input type="password" id="passphrase" name="passphrase" class="form-control" value=""> 
          		<small class="form-text text-muted" jad:bundle="authorizedKeys" jad:i18n="passphrase.desc"></small> 
         	</div>
         	<div class="form-group"> 
          		<label for="confirmPassphrase" class="col-form-label" jad:bundle="authorizedKeys" jad:i18n="confirmPassphrase.name">Confirm Passphrase</label> 
          		<input type="password" id="confirmPassphrase" name="confirmPassphrase" class="form-control" value=""> 
          		<small class="form-text text-muted" jad:bundle="authorizedKeys" jad:i18n="confirmPassphrase.desc"></small> 
         	</div>
         	<div class="form-group text-right">
    			<button id="generateButton" class="btn btn-primary"><i class="far fa-file-plus"></i>&nbsp;<span jad:bundle="authorizedKeys" jad:i18n="generate.name">Generate</span></button>
    		</div>
		</form>
		</div>
         </div>
         </div>
   </div>
</main>
</div>
<script type="text/javascript">

$(document).ready(function() {
	
	$('#generateForm').submit(function() {
		$('.alert').remove();
		if($('#passphrase').val() !== $('#confirmPassphrase').val()) {
			$('.card-body').prepend('<div class="alert alert-danger"><i class="far fa-exclamation-square"></i>  Passphrases do not match!</div>');
			return;
		}
		$.post($(this).attr('action'), $(this).serialize(), function(data) {
		      if(data.success) {
		    	  window.location = '/app/ui/download-key';
		      } else {
		    	  $('.card-body').prepend('<div class="alert alert-danger"><i class="far fa-exclamation-square"></i> ' + data.message + '</div>');
		      }
		}, 'json');
		return false;
	});
});
    
</script>
<footer jad:id="footer"></footer>
</body>
</html>